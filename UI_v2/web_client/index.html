<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SMC Viewer v2 (Web)</title>
    <link rel="stylesheet" href="styles.css?v=20251221_3" />
</head>

<body class="ui-view-overview">
    <header class="app-header">
        <div class="header-left">
            <label for="symbol-select">Символ:</label>
            <select id="symbol-select"></select>
            <label for="timeframe-select">Таймфрейм:</label>
            <select id="timeframe-select">
                <option value="1m">1m</option>
                <option value="5m">5m</option>
                <option value="1h">1h</option>
                <option value="4h">4h</option>
            </select>
        </div>
        <div class="header-right">
            <button id="summary-toggle-btn" type="button" class="chart-fullscreen-btn" aria-label="Згорнути підсумок"
                title="Згорнути підсумок" aria-pressed="false">Σ</button>
            <span id="ws-status" class="status-pill status-disconnected">Відключено</span>
            <span id="market-status" class="status-pill status-stale">FX: -</span>
            <div class="status-meta">
                <span class="status-meta__item" id="payload-ts">Payload ts: -</span>
                <span class="status-meta__item" id="payload-lag">Lag (s): -</span>
                <span class="status-meta__item" id="active-zones">active_zones: -/6</span>
                <span class="status-meta__item" id="exec-status">EXEC: -</span>
                <span class="status-meta__item" id="tf-health">TF health: -</span>
            </div>
        </div>
    </header>

    <header id="mobile-header-overview" class="mobile-header mobile-header--overview"
        aria-label="Мобільна шапка: огляд">
        <div class="mobile-header__left">
            <div class="mobile-header__symbol" id="m-overview-symbol">XAUUSD</div>
            <div class="mobile-header__price" id="m-overview-price">-</div>
        </div>
        <div class="mobile-header__right">
            <div class="mobile-header__delta" id="m-overview-delta">-</div>
            <button id="m-overview-summary-toggle" type="button" class="mobile-icon-btn" aria-label="Підсумок"
                title="Підсумок" aria-pressed="false">Σ</button>
            <span id="m-overview-ws" class="status-pill status-disconnected">Відключено</span>
        </div>
    </header>

    <header id="mobile-header-chart" class="mobile-header mobile-header--chart" aria-label="Мобільна шапка: графік">
        <div class="mobile-header__left">
            <button id="m-chart-back" type="button" class="mobile-icon-btn" aria-label="Назад до огляду">Огляд</button>
            <div class="mobile-header__symbol" id="m-chart-symbol">XAUUSD</div>
            <div class="mobile-header__price" id="m-chart-price">-</div>
        </div>
        <div class="mobile-header__right">
            <button id="m-chart-summary-toggle" type="button" class="mobile-icon-btn" aria-label="Підсумок"
                title="Підсумок" aria-pressed="false">Σ</button>
            <button id="m-chart-menu" type="button" class="mobile-icon-btn" aria-label="Фільтри">⋮</button>
        </div>
    </header>

    <main class="app-main">
        <section class="summary" aria-label="Підсумок">
            <div class="summary-grid">
                <div>
                    <span class="label">Символ</span>
                    <span id="summary-symbol" class="value">-</span>
                </div>
                <div>
                    <span class="label">Ціна</span>
                    <span id="summary-price" class="value">-</span>
                </div>
                <div>
                    <span class="label">Сесія</span>
                    <span id="summary-session" class="value">-</span>
                </div>
                <div>
                    <span class="label">Тренд</span>
                    <span id="summary-trend" class="summary-badge">-</span>
                </div>
                <div>
                    <span class="label">Bias</span>
                    <span id="summary-bias" class="summary-badge">-</span>
                </div>
                <div>
                    <span class="label">Діапазон</span>
                    <span id="summary-range" class="summary-badge">-</span>
                </div>
                <div>
                    <span class="label">AMD</span>
                    <span id="summary-amd" class="summary-badge">-</span>
                </div>
                <div>
                    <span class="label">FX</span>
                    <span id="summary-market" class="value">-</span>
                </div>
                <div>
                    <span class="label">Процес</span>
                    <span id="summary-process" class="value">-</span>
                </div>
                <div>
                    <span class="label">Лаг (с)</span>
                    <span id="summary-lag" class="value">-</span>
                </div>
                <div>
                    <span class="label">VOL src</span>
                    <span id="summary-vol-src" class="value">-</span>
                </div>
            </div>
        </section>

        <section id="view-overview" class="ui-view" aria-label="Огляд">
            <section class="card card-overview-events" aria-label="Останні події">
                <h2 class="card-title">Останні події</h2>
                <div id="overview-events-list" class="overview-events-list"></div>
            </section>

            <div id="overview-chart-slot" class="chart-slot" aria-label="Міні-графік"></div>
        </section>

        <section id="view-chart" class="ui-view" aria-label="Графік">
            <div id="chart-slot" class="chart-slot" aria-label="Графік"></div>

            <section class="card card-chart" aria-label="Графік">
                <div class="chart-overlay-shell" aria-label="Графік">
                    <div id="chart-container" class="chart-demo-container"></div>
                    <div id="chart-poi-label-layer" class="chart-poi-label-layer" aria-hidden="true"></div>
                    <div id="chart-hover-tooltip" class="chart-hover-tooltip" hidden></div>

                    <aside id="stage6-panel" class="stage6-panel" aria-label="SMC контекст (пояснювач)">
                        <div class="stage6-panel__header">
                            <div class="stage6-panel__heading">
                                <div class="stage6-panel__title">SMC Контекст</div>
                                <div class="stage6-panel__subtitle">Режим ринку (контекст), не сигнал</div>
                            </div>
                        </div>
                        <div id="stage6-nodata" class="stage6-panel__nodata" hidden>Немає контексту</div>
                        <div id="stage6-grid" class="stage6-panel__grid">
                            <div class="stage6-row">
                                <div class="label">Режим</div>
                                <div id="stage6-mode" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">stable_conf</div>
                                <div class="stage6-panel__value">
                                    <div id="stage6-stable-conf">немає даних</div>
                                    <div class="stage6-progress" aria-hidden="true">
                                        <div id="stage6-stable-conf-bar" class="stage6-progress__bar"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">Що думаю зараз</div>
                                <div id="stage6-raw-line" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">Pending</div>
                                <div id="stage6-pending-line" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">Чому</div>
                                <div id="stage6-why" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">DR</div>
                                <div id="stage6-htf-dr" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">PD</div>
                                <div id="stage6-htf-pd" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">ATR14</div>
                                <div id="stage6-htf-atr" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">Sweep</div>
                                <div id="stage6-sweep" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">Hold above</div>
                                <div id="stage6-hold" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">Failed hold</div>
                                <div id="stage6-failed-hold" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">Targets</div>
                                <div id="stage6-targets" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">POI</div>
                                <div id="stage6-poi" class="stage6-panel__value">немає даних</div>
                            </div>

                            <div class="stage6-row">
                                <div class="label">TTL</div>
                                <div id="stage6-antiflip-ttl" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">blocked</div>
                                <div id="stage6-antiflip-blocked" class="stage6-panel__value">немає даних</div>
                            </div>
                            <div class="stage6-row">
                                <div class="label">override</div>
                                <div id="stage6-antiflip-override" class="stage6-panel__value">немає даних</div>
                            </div>
                        </div>
                    </aside>

                    <div class="chart-overlay-actions" role="group" aria-label="Керування графіком">
                        <div class="chart-overlay-actions__left" aria-hidden="false">
                            <button id="chart-layer-menu-btn" type="button" class="chart-layer-menu-btn" aria-label="Шари"
                                aria-haspopup="true" aria-expanded="false">▾</button>
                            <button id="chart-size-toggle-btn" type="button" class="chart-fullscreen-btn"
                                aria-label="Збільшити графік" title="Збільшити до 900" aria-pressed="false">x2</button>
                            <button id="chart-fullscreen-btn" type="button" class="chart-fullscreen-btn"
                                aria-label="На весь екран" title="На весь екран" aria-pressed="false">
                                <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" focusable="false">
                                    <path fill="currentColor"
                                        d="M7 14H5v5h5v-2H7v-3zm0-4h3V7h3V5H5v5h2V7h3v3zm10 7h-3v2h5v-5h-2v3zm0-10V5h-5v2h3v3h2z" />
                                </svg>
                            </button>
                        </div>
                        <div class="chart-overlay-actions__right" aria-hidden="false">
                            <button id="stage6-toggle-btn" type="button" class="stage6-panel__toggle" aria-label="Згорнути SMC контекст" title="Згорнути SMC контекст" aria-pressed="false">S6</button>
                        </div>
                    </div>
                    <div id="chart-layer-menu" class="chart-layer-menu" hidden>
                        <div class="chart-layer-controls" role="group" aria-label="Керування шарами">
                            <label class="layer-toggle">
                                <input type="checkbox" id="layer-toggle-events" checked />
                                <span class="layer-toggle__dot layer-toggle__dot--events" aria-hidden="true"></span>
                                <span class="layer-toggle__text">BOS / CHOCH</span>
                            </label>
                            <label class="layer-toggle">
                                <input type="checkbox" id="layer-toggle-pools" checked />
                                <span class="layer-toggle__dot layer-toggle__dot--pools" aria-hidden="true"></span>
                                <span class="layer-toggle__text">Pools</span>
                            </label>
                            <label class="layer-toggle">
                                <input type="checkbox" id="layer-toggle-ote" checked />
                                <span class="layer-toggle__dot layer-toggle__dot--ote" aria-hidden="true"></span>
                                <span class="layer-toggle__text">OTE</span>
                            </label>
                            <label class="layer-toggle">
                                <input type="checkbox" id="layer-toggle-zones" checked />
                                <span class="layer-toggle__dot layer-toggle__dot--zones" aria-hidden="true"></span>
                                <span class="layer-toggle__text">Zones</span>
                            </label>
                            <label class="layer-toggle">
                                <input type="checkbox" id="layer-toggle-sessions" checked />
                                <span class="layer-toggle__dot layer-toggle__dot--sessions" aria-hidden="true"></span>
                                <span class="layer-toggle__text">Сесії (UTC)</span>
                            </label>
                        </div>

                        <div class="chart-layer-controls" role="group" aria-label="Налаштування зон">
                            <label class="layer-toggle layer-toggle--select">
                                <span class="layer-toggle__text">Ліміт зон</span>
                                <select id="zones-limit-select" aria-label="Ліміт зон (для 1m)">
                                    <option value="near2">Дефолт (2 + 2 + в зоні)</option>
                                    <option value="near1">Ліміт 2 (1 + 1 + в зоні)</option>
                                    <option value="all">Без ліміту</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="card card-ohlcv" aria-labelledby="ohlcv-title" hidden>
                <h2 id="ohlcv-title" class="card-title">OHLCV Debug</h2>
                <div class="summary-grid summary-grid-ohlcv">
                    <div class="summary-item">
                        <span class="summary-label">ТФ</span>
                        <span id="ohlcv-tf" class="summary-value">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Барів</span>
                        <span id="ohlcv-count" class="summary-value">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Останній час</span>
                        <span id="ohlcv-last-time" class="summary-value">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Останнє закриття</span>
                        <span id="ohlcv-last-close" class="summary-value">-</span>
                    </div>
                </div>
            </section>

            <section class="panel debug-only" aria-labelledby="events-title">
                <div class="panel-header">
                    <h3 id="events-title">Structure Events (BOS / CHOCH)</h3>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Type</th>
                            <th>Direction</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody id="events-body"></tbody>
                </table>
            </section>

            <section class="panel debug-only" aria-labelledby="ote-title">
                <div class="panel-header">
                    <h3 id="ote-title">OTE Zones</h3>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Direction</th>
                            <th>Role</th>
                            <th>OTE min</th>
                            <th>OTE max</th>
                        </tr>
                    </thead>
                    <tbody id="ote-body"></tbody>
                </table>
            </section>

            <section class="panel debug-only" aria-labelledby="pools-title">
                <div class="panel-header">
                    <h3 id="pools-title">Liquidity Pools</h3>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Role</th>
                            <th>Price</th>
                            <th>Strength / Touches</th>
                        </tr>
                    </thead>
                    <tbody id="pools-body"></tbody>
                </table>
            </section>

            <section class="panel debug-only" aria-labelledby="zones-title">
                <div class="panel-header">
                    <h3 id="zones-title">Zones</h3>
                </div>
                <table class="zones-table">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Role</th>
                            <th>Price min</th>
                            <th>Price max</th>
                        </tr>
                    </thead>
                    <tbody id="zones-body"></tbody>
                </table>
            </section>
        </section>
    </main>

    <nav id="bottom-nav" class="bottom-nav" aria-label="Нижня навігація">
        <button type="button" class="bottom-nav__btn" data-view="overview">Огляд</button>
        <button type="button" class="bottom-nav__btn" data-view="chart">Графік</button>
        <button type="button" class="bottom-nav__btn" data-action="filters">Фільтри</button>
        <button type="button" class="bottom-nav__btn" data-view="debug" disabled hidden>Debug</button>
    </nav>

    <aside id="filters-drawer" class="filters-drawer" aria-label="Фільтри">
        <div class="filters-drawer__header">
            <div class="filters-drawer__title">Фільтри</div>
            <button id="drawer-close" type="button" class="mobile-icon-btn" aria-label="Закрити">✕</button>
        </div>
        <div class="filters-drawer__body">
            <div class="filters-group" aria-label="Шари">
                <label class="drawer-toggle">
                    <input type="checkbox" id="drawer-layer-events" checked />
                    <span>BOS / CHOCH</span>
                </label>
                <label class="drawer-toggle">
                    <input type="checkbox" id="drawer-layer-pools" checked />
                    <span>Pools</span>
                </label>
                <label class="drawer-toggle">
                    <input type="checkbox" id="drawer-layer-ote" checked />
                    <span>OTE</span>
                </label>
                <label class="drawer-toggle">
                    <input type="checkbox" id="drawer-layer-zones" checked />
                    <span>Zones</span>
                </label>
                <label class="drawer-toggle">
                    <input type="checkbox" id="drawer-layer-sessions" checked />
                    <span>Сесії (UTC)</span>
                </label>
            </div>

            <div class="filters-group" aria-label="Зони">
                <label for="zones-limit-select-mobile" class="filters-label">Ліміт зон (1m)</label>
                <select id="zones-limit-select-mobile">
                    <option value="near2">Як зараз (2 + 2 + в зоні)</option>
                    <option value="near1">Ліміт 2 (1 + 1 + в зоні)</option>
                    <option value="all">Без ліміту</option>
                </select>
            </div>

            <div class="filters-group" aria-label="Таймфрейм">
                <label for="timeframe-select-mobile" class="filters-label">Таймфрейм</label>
                <select id="timeframe-select-mobile">
                    <option value="1m">1m</option>
                    <option value="5m">5m</option>
                    <option value="1h">1h</option>
                    <option value="4h">4h</option>
                </select>
            </div>
        </div>
    </aside>
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
    <script src="chart_adapter.js?v=20251227_1529"></script>
    <script src="app.js?v=20251227_1529"></script>
</body>

</html>
